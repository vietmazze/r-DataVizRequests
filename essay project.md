---
title: "Essay Graphs for r/Datavizrequest user"
author: "Duy Nguyen"
date: "August 10, 2017"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(readxl)
library(stringr)
library(lubridate)
library(chron)
```

##Reading excel file
```{r import,cache=TRUE}
test<-read_excel("Undergrad Essays Written.xlsx",1,col_names=FALSE,skip=1)


```

##Fixing the data
```{r fix,results = "hide", cache=TRUE}
colnames(test)<-c("Year","Date","Time")

test<-test%>%
  separate(Year,into=c("Year","Semester"),sep=",")

test$Year[[1]]<-("1.0")
test$Year[[10]]<-("1.0")
test$Year[[20]]<-("2.0")
test$Year[[32]]<-("2.0")
test$Year[[49]]<-("3.0")
test$Year[[59]]<-("3.0")
test$Year[[71]]<-("4.0")
test$Year[[90]]<-("4.0")

test$Semester[[1]]<-("1")
test$Semester[[10]]<-("2")
test$Semester[[20]]<-("1")
test$Semester[[32]]<-("2")
test$Semester[[49]]<-("1")
test$Semester[[59]]<-("2")
test$Semester[[71]]<-("1")
test$Semester[[90]]<-("2")

test<-test%>%
  fill(Year)
test<-test%>%
  fill(Semester)
test$Year<-as.numeric(test$Year)
test$Semester<-as.numeric(test$Semester)
test<-as.tibble(test, na.rm=TRUE)


```


##Converting to datetime variable
```{r time}
test$Time<-as.numeric(test$Time)
test$Time<-chron::times(test$Time)


test<- test%>% 
  unite(datetime,Date,Time,sep=" ")

test<-test[-21,]
test$datetime<-parse_datetime(test$datetime,"%Y-%m-%d %H:%M:%S")
```

# Looking at tidy data
```{r data2}
knitr::kable(
 test , 
  caption = "Essay"
)
```
[1] "| Year| Semester|datetime            |"
  [2] "|----:|--------:|:-------------------|"
  [3] "|    1|        1|2012-09-05 21:54:00 |"
  [4] "|    1|        1|2012-09-25 23:28:00 |"
  [5] "|    1|        1|2012-10-18 21:49:00 |"
  [6] "|    1|        1|2012-10-27 23:29:00 |"
  [7] "|    1|        1|2012-10-29 02:07:00 |"
  [8] "|    1|        1|2012-11-02 12:12:00 |"
  [9] "|    1|        1|2012-12-03 21:46:00 |"
 [10] "|    1|        1|2012-12-06 02:19:00 |"
 [11] "|    1|        1|2012-12-11 22:13:00 |"
 [12] "|    1|        2|2013-02-15 20:44:00 |"
 [13] "|    1|        2|2013-02-26 22:52:00 |"
 [14] "|    1|        2|2013-02-28 20:36:00 |"
 [15] "|    1|        2|2013-03-27 20:20:00 |"
 [16] "|    1|        2|2013-04-09 19:34:00 |"
 [17] "|    1|        2|2013-04-22 17:38:00 |"
 [18] "|    1|        2|2013-04-23 21:48:00 |"
 [19] "|    1|        2|2013-04-25 12:40:00 |"
 [20] "|    1|        2|2013-05-15 09:05:00 |"
 [21] "|    1|        2|2013-05-31 22:09:00 |"
 [22] "|    2|        1|2013-10-06 19:12:00 |"
 [23] "|    2|        1|2013-11-05 22:06:00 |"
 [24] "|    2|        1|2013-11-11 17:39:00 |"
 [25] "|    2|        1|2013-11-25 17:42:00 |"
 [26] "|    2|        1|2013-12-01 23:50:00 |"
 [27] "|    2|        1|2013-12-03 20:10:00 |"
 [28] "|    2|        1|2013-12-05 21:03:00 |"
 [29] "|    2|        1|2013-12-05 21:23:00 |"
 [30] "|    2|        1|2013-12-09 16:02:00 |"
 [31] "|    2|        1|2013-12-12 23:23:00 |"
 [32] "|    2|        1|2013-12-16 22:27:00 |"
 [33] "|    2|        2|2014-02-26 22:10:00 |"
 [34] "|    2|        2|2014-03-04 23:19:00 |"
 [35] "|    2|        2|2014-03-05 15:04:00 |"
 [36] "|    2|        2|2014-03-18 01:08:00 |"
 [37] "|    2|        2|2014-03-26 23:14:00 |"
 [38] "|    2|        2|2014-04-03 13:59:00 |"
 [39] "|    2|        2|2014-04-15 22:38:00 |"
 [40] "|    2|        2|2014-04-21 22:05:00 |"
 [41] "|    2|        2|2014-04-23 12:53:00 |"
 [42] "|    2|        2|2014-04-23 15:10:00 |"
 [43] "|    2|        2|2014-04-23 19:39:00 |"
 [44] "|    2|        2|2014-04-20 16:33:00 |"
 [45] "|    2|        2|2014-05-05 15:58:00 |"
 [46] "|    2|        2|2014-05-06 00:03:00 |"
 [47] "|    2|        2|2014-05-11 21:39:00 |"
 [48] "|    2|        2|2014-05-12 20:17:00 |"
 [49] "|    2|        2|2014-05-13 12:24:00 |"
 [50] "|    3|        1|2014-09-22 10:14:00 |"
 [51] "|    3|        1|2014-09-29 00:48:00 |"
 [52] "|    3|        1|2014-11-03 22:33:00 |"
 [53] "|    3|        1|2014-11-18 10:52:00 |"
 [54] "|    3|        1|2014-12-05 23:37:00 |"
 [55] "|    3|        1|2014-12-07 20:34:00 |"
 [56] "|    3|        1|2014-12-08 22:22:00 |"
 [57] "|    3|        1|2014-12-15 12:16:00 |"
 [58] "|    3|        1|2014-12-16 21:44:00 |"
 [59] "|    3|        1|2014-12-20 13:33:00 |"
 [60] "|    3|        2|2015-09-24 22:47:00 |"
 [61] "|    3|        2|2015-10-06 22:59:00 |"
 [62] "|    3|        2|2015-10-22 14:14:00 |"
 [63] "|    3|        2|2015-10-22 15:24:00 |"
 [64] "|    3|        2|2015-11-11 23:17:00 |"
 [65] "|    3|        2|2015-11-30 11:48:00 |"
 [66] "|    3|        2|2015-12-11 14:56:00 |"
 [67] "|    3|        2|2015-12-14 13:56:00 |"
 [68] "|    3|        2|2015-12-14 23:55:00 |"
 [69] "|    3|        2|2015-12-17 00:10:00 |"
 [70] "|    3|        2|2015-12-17 14:25:00 |"
 [71] "|    3|        2|2015-12-18 21:08:00 |"
 [72] "|    4|        1|2016-10-02 15:17:00 |"
 [73] "|    4|        1|2016-10-03 18:07:00 |"
 [74] "|    4|        1|2016-10-05 20:51:00 |"
 [75] "|    4|        1|2016-10-15 12:00:00 |"
 [76] "|    4|        1|2016-10-27 18:39:00 |"
 [77] "|    4|        1|2016-10-30 17:45:00 |"
 [78] "|    4|        1|2016-11-10 11:54:00 |"
 [79] "|    4|        1|2016-11-16 11:09:00 |"
 [80] "|    4|        1|2016-11-20 15:33:00 |"
 [81] "|    4|        1|2016-11-26 19:27:00 |"
 [82] "|    4|        1|2016-11-30 23:21:00 |"
 [83] "|    4|        1|2016-12-06 17:08:00 |"
 [84] "|    4|        1|2016-12-07 11:16:00 |"
 [85] "|    4|        1|2016-12-09 14:33:00 |"
 [86] "|    4|        1|2016-12-10 01:14:00 |"
 [87] "|    4|        1|2016-12-11 12:49:00 |"
 [88] "|    4|        1|2016-12-11 09:54:00 |"
 [89] "|    4|        1|2016-12-15 00:14:00 |"
 [90] "|    4|        1|2016-12-17 12:14:00 |"
 [91] "|    4|        2|2017-02-06 22:41:00 |"
 [92] "|    4|        2|2017-02-11 21:09:00 |"
 [93] "|    4|        2|2017-02-13 15:39:00 |"
 [94] "|    4|        2|2017-02-19 12:39:00 |"
 [95] "|    4|        2|2017-02-20 20:40:00 |"
 [96] "|    4|        2|2017-03-04 11:11:00 |"
 [97] "|    4|        2|2017-03-06 17:34:00 |"
 [98] "|    4|        2|2017-03-08 19:17:00 |"
 [99] "|    4|        2|2017-03-16 12:10:00 |"
[100] "|    4|        2|2017-04-03 16:19:00 |"
[101] "|    4|        2|2017-04-03 21:31:00 |"
[102] "|    4|        2|2017-04-10 17:25:00 |"
[103] "|    4|        2|2017-04-18 20:10:00 |"
[104] "|    4|        2|2017-04-28 05:01:00 |"
[105] "|    4|        2|2017-05-01 14:52:00 |"
[106] "|    4|        2|2017-05-04 23:41:00 |"
[107] "|    4|        2|2017-05-09 16:21:00 |"
[108] "|    4|        2|2017-05-09 22:20:00 |"
[109] "|    4|        2|2017-05-10 00:51:00 |"
[110] "|    4|        2|2017-05-11 17:03:00 |"


#Graphing histogram and boxplot for data

```{r graphing}
ggplot(test,aes(hour(datetime)))+
  geom_histogram(bins=40,color="black",fill="steelblue1")+
  labs(title="Essays", x="Hour",y="Number",caption="created by DQN")+
  facet_grid(paste("year",Year)~paste("semester",Semester))+
  theme_bw()
```
![alt text](https://github.com/vietmazze/r-DataVizRequests/blob/master/graph1%20essay%20project.jpeg "Histogram")

```{r graphing1}
ggplot(test,aes(y=hour(datetime),x=Year,group=Semester))+
  geom_boxplot(color="blue")+
  facet_grid(paste("year",Year)~paste("semester",Semester))+
  labs(title="Summary of time used the most to do essay",x="Year",y="Hour")+
  theme_bw()
```
![alt text](https://github.com/vietmazze/r-DataVizRequests/blob/master/boxplot%20for%20essay%20project.jpeg "Boxplot")
